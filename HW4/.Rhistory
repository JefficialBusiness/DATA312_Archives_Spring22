my_tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(my_tH_lfit_y, x), color = 'blue')
my_tH_polyfit <- my_tH %>%
add_predictions(my_tH_polyfit, var = 'my_tH_polyfit_y') %>%
add_residuals(my_tH_polyfit, var = 'my_tH_polyfit_resid')
my_tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x,my_tH_polyfit_y), color='green')
my_tF %>% my_training %>% filter(Group == 'F')
my_tF <- my_training %>% filter(Group == 'F')
my_tF %>% View()
my_tH_polyfit <- lm(y~poly(x, 15), my_tH)
my_tH_lfit <- my_tH %>%
add_predictions(my_tH_lfit, var = 'my_tH_lfit_y')
my_tH <- my_training %>% filter(Group == 'H')
my_tH_lfit <- lm(y~x, data = my_tH)
my_tH_polyfit <- lm(y~poly(x, 15), my_tH)
my_tH_lfit <- my_tH %>%
add_predictions(my_tH_lfit, var = 'my_tH_lfit_y')
my_tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(my_tH_lfit_y, x), color = 'blue')
my_tH_polyfit <- my_tH %>%
add_predictions(my_tH_polyfit, var = 'my_tH_polyfit_y') %>%
add_residuals(my_tH_polyfit, var = 'my_tH_polyfit_resid')
my_tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x,my_tH_polyfit_y), color='green')
my_tH <- my_training %>% filter(Group == 'H')
my_tH_lfit <- lm(y~x, data = my_tH)
my_tH_polyfit <- lm(y~poly(x, 4), my_tH)
my_tH_lfit <- my_tH %>%
add_predictions(my_tH_lfit, var = 'my_tH_lfit_y')
my_tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(my_tH_lfit_y, x), color = 'blue')
my_tH_polyfit <- my_tH %>%
add_predictions(my_tH_polyfit, var = 'my_tH_polyfit_y') %>%
add_residuals(my_tH_polyfit, var = 'my_tH_polyfit_resid')
my_tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x,my_tH_polyfit_y), color='green')
my_tH <- my_training %>% filter(Group == 'H')
my_tH_lfit <- lm(y~x, data = my_tH)
my_tH_polyfit <- lm(y~poly(x, 1), my_tH)
my_tH_lfit <- my_tH %>%
add_predictions(my_tH_lfit, var = 'my_tH_lfit_y')
my_tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(my_tH_lfit_y, x), color = 'blue')
my_tH_polyfit <- my_tH %>%
add_predictions(my_tH_polyfit, var = 'my_tH_polyfit_y') %>%
add_residuals(my_tH_polyfit, var = 'my_tH_polyfit_resid')
my_tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x,my_tH_polyfit_y), color='green')
my_tH <- my_training %>% filter(Group == 'H')
my_tH_lfit <- lm(y~x, data = my_tH)
my_tH_polyfit <- lm(y~poly(x, 2), my_tH)
my_tH_lfit <- my_tH %>%
add_predictions(my_tH_lfit, var = 'my_tH_lfit_y')
my_tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(my_tH_lfit_y, x), color = 'blue')
my_tH_polyfit <- my_tH %>%
add_predictions(my_tH_polyfit, var = 'my_tH_polyfit_y') %>%
add_residuals(my_tH_polyfit, var = 'my_tH_polyfit_resid')
my_tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x,my_tH_polyfit_y), color='green')
my_qH_polyfit <- my_query %>% filter(Group == 'H')
my_qH <- my_query %>% filter(Group == 'H')
my_tH <- my_training %>% filter(Group == 'H')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
H_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y')
H_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
H_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
my_tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
H_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
my_qH <- my_query %>% filter(Group == 'H')
my_qH %>% add_residuals(H_lfit, var = 'H_lfit_resid') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
my_qH %>% add_residuals(H_lfit, var = 'H_lfit_resid') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
my_qH <- my_query %>% filter(Group == 'H')
my_qH %>% add_residuals(H_lfit, var = 'H_lfit_resid') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
my_tH <- my_training %>% filter(Group == 'H')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
H_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y')
H_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
H_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
H_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
my_qH <- my_query %>% filter(Group == 'H')
my_qH %>% add_residuals(H_lfit, var = 'H_lfit_resid') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
my_tF <- my_training %>% filter(Group == 'F')
my_qH %>% add_residuals(H_lfit, var = 'H_lfit_resid') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
my_tH <- my_training %>% filter(Group == 'H')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
H_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y')
H_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
H_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
H_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
my_qH <- my_query %>% filter(Group == 'H')
my_qH %>% add_residuals(H_lfit, var = 'H_lfit_resid') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
my_qH <- my_query %>% filter(Group == 'H') %>% add_residuals(H_lfit, var = 'H_lfit_resid') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
# Cleaning workspace / loading libraries
rm(list = ls())
gc()
library(tidyverse)
library(modelr)
# Loading raw data
my_data <- read_csv('5030143_HW4A.csv')
# Sampling
my_samplingframe <- my_data %>%
mutate(snum = sample.int(n(), n()) / n())
my_training <- my_samplingframe %>% filter(snum < 0.6) %>% select(-snum)
my_query <- my_samplingframe %>% filter(snum >= 0.6, snum < 0.8) %>%
select(-snum)
my_test <- my_samplingframe %>% filter(snum > 0.8) %>% select(-snum)
my_training %>% write_csv('5030143_training.csv')
my_query %>% write_csv('5030143_query.csv')
my_test %>% write_csv('5030143_test.csv')
my_training %>% filter(t == 1) %>% ggplot(aes(x, y)) + geom_point()
my_training %>% filter(t == 0) %>% ggplot(aes(x, y)) + geom_point()
my_training %>% count(Group) %>% select(n) %>% chisq.test()
my_training %>% ggplot(aes(x, y, color = Group)) + geom_point() +
facet_grid(vars(s), vars(t))
my_training %>% filter(Group == 'H') %>%
ggplot(aes(x, y, color = Group)) + geom_point() +
facet_grid(vars(s), vars(t))
my_training %>% filter(Group == 'H') %>% ggplot(aes(y, x)) + geom_point()
my_training %>% filter(t == 1) %>% ggplot(aes(x, y)) + geom_point()
my_tH <- my_training %>% filter(Group == 'H')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
H_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y')
H_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
H_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
H_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
my_qH <- my_query %>% filter(Group == 'H')
my_qH %>% add_residuals(H_lfit, var = 'H_lfit_resid') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
my_qH %>% ggplot(aes(x, y)) + geom_point()
my_tH %>% filter(Group == 'H')
my_tH %>% ggplot(aes(x, y)) + geom_point()
my_qH %>% ggplot(aes(x, y)) + geom_point()
H_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y') %>%
add_residuals(H_lfit, var = 'H_lfit_resid')
my_tH <- my_training %>% filter(Group == 'H')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
H_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y') %>%
add_residuals(H_lfit, var = 'H_lfit_resid')
H_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
H_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
H_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
my_qH <- my_query %>% filter(Group == 'H')
my_qH %>% add_residuals(H_lfit, var = 'H_lfit_resid') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
my_qH %>% add_residuals(H_lfit, var = 'H_lfit_y') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_lfit_y') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
my_tH <- my_training %>% filter(Group == 'H')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
H_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y') %>%
add_residuals(H_lfit, var = 'H_lfit_resid')
H_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
H_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
H_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
my_qH <- my_query %>% filter(Group == 'H')
my_qH %>% add_residuals(H_lfit, var = 'H_lfit_y') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_lfit_y') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
my_qH <- my_query %>% filter(Group == 'H') %>%
add_residuals(H_lfit, var = 'H_lfit_y') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_polyfit, var = 'H_lfit_y') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
my_qH <- my_query %>% filter(Group == 'H') %>%
add_predictions(H_lfit, var = 'H_lfit_pred') %>%
add_residuals(H_lfit, var = 'H_lfit_y') %>%
add_predictions(H_polyfit, var = 'H_polyfit_pred')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(H_lfit, var='H_lfit_resid') %>%
add_predictions(H_lfit, var='lfit_pred') %>%
add_residuals(polyfit,var='H_polyfit_resid') %>%
add_predictions(polyfit,var='polyfit_pred')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(H_lfit, var='H_lfit_resid') %>%
add_predictions(H_lfit, var='lfit_pred') %>%
add_residuals(H_polyfit,var='H_polyfit_resid') %>%
add_predictions(H_polyfit,var='polyfit_pred')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(H_lfit, var='H_lfit_resid') %>%
add_predictions(H_lfit, var='H_polyfit_pred') %>%
add_residuals(H_polyfit,var='H_polyfit_resid') %>%
add_predictions(H_polyfit,var='H_polyfit_pred')
H_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
my_tH <- my_training %>% filter(Group == 'H')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
H_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y') %>%
add_residuals(H_lfit, var = 'H_lfit_resid')
H_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
H_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
my_tH <- my_training %>% filter(Group == 'H')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(H_lfit, var='H_lfit_resid') %>%
add_predictions(H_lfit, var='H_polyfit_pred') %>%
add_residuals(H_polyfit,var='H_polyfit_resid') %>%
add_predictions(H_polyfit,var='H_polyfit_pred')
my_tH <- my_training %>% filter(Group == 'H')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
H_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y') %>%
add_residuals(H_lfit, var = 'H_lfit_resid')
H_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
H_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
H_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(H_lfit, var='H_lfit_resid') %>%
add_predictions(H_lfit, var='H_polyfit_pred') %>%
add_residuals(H_polyfit,var='H_polyfit_resid') %>%
add_predictions(H_polyfit,var='H_polyfit_pred')
my_tH <- my_training %>% filter(Group == 'H')
my_training %>% write_csv('5030143_training.csv')
my_query %>% write_csv('5030143_query.csv')
my_test %>% write_csv('5030143_test.csv')
my_tH <- my_training %>% filter(Group == 'H')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
tH_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y') %>%
add_residuals(H_lfit, var = 'H_lfit_resid')
tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
tH_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(H_lfit, var='qH_lfit_resid') %>%
add_predictions(H_lfit, var='qH_polyfit_pred') %>%
add_residuals(H_polyfit,var='qH_polyfit_resid') %>%
add_predictions(H_polyfit,var='qH_polyfit_pred')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(qH_lfit, var='qH_lfit_resid') %>%
add_predictions(qH_lfit, var='qH_polyfit_pred') %>%
add_residuals(qH_polyfit,var='qH_polyfit_resid') %>%
add_predictions(qH_polyfit,var='qH_polyfit_pred')
tH_lfit <- lm(y~x, data = my_tH)
tH_polyfit <- lm(y~poly(x, 2), my_tH)
tH_lfit <- my_tH %>%
add_predictions(tH_lfit, var = 'tH_lfit_y') %>%
add_residuals(tH_lfit, var = 'tH_lfit_resid')
tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(tH_lfit_y, x), color = 'blue')
tH_polyfit <- my_tH %>%
add_predictions(tH_polyfit, var = 'tH_polyfit_y') %>%
add_residuals(tH_polyfit, var = 'tH_polyfit_resid')
tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(H_lfit, var='H_lfit_resid') %>%
add_predictions(H_lfit, var='H_polyfit_pred') %>%
add_residuals(H_polyfit,var='H_polyfit_resid') %>%
add_predictions(H_polyfit,var='H_polyfit_pred')
tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, tH_polyfit_y), color='green')
my_tH <- my_training %>% filter(Group == 'H')
tH_lfit <- lm(y~x, data = my_tH)
tH_polyfit <- lm(y~poly(x, 2), my_tH)
tH_lfit <- my_tH %>%
add_predictions(tH_lfit, var = 'tH_lfit_y') %>%
add_residuals(tH_lfit, var = 'tH_lfit_resid')
tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(tH_lfit_y, x), color = 'blue')
tH_polyfit <- my_tH %>%
add_predictions(tH_polyfit, var = 'tH_polyfit_y') %>%
add_residuals(tH_polyfit, var = 'tH_polyfit_resid')
tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, tH_polyfit_y), color='green')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(tH_lfit, var='qH_lfit_resid') %>%
add_predictions(tH_lfit, var='qH_polyfit_pred') %>%
add_residuals(tH_polyfit,var='qH_polyfit_resid') %>%
add_predictions(tH_polyfit,var='qH_polyfit_pred')
lfit <- lm(y~x, data = my_tH)
polyfit <- lm(y~poly(x, 2), my_tH)
my_tH <- my_training %>% filter(Group == 'H')
lfit <- lm(y~x, data = my_tH)
polyfit <- lm(y~poly(x, 2), my_tH)
lfit <- lm(y~x, data = my_tH)
polyfit <- lm(y~poly(x, 2), my_tH)
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
tH_lfit <- my_tH %>%
add_predictions(lfit, var = 'H_lfit_y') %>%
add_residuals(lfit, var = 'H_lfit_resid')
tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(lfit_y, x), color = 'blue')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 2), my_tH)
tH_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y') %>%
add_residuals(H_lfit, var = 'H_lfit_resid')
tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(lfit_y, x), color = 'blue')
tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
tH_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'polyfit_y') %>%
add_residuals(H_polyfit, var = 'polyfit_resid')
tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, tH_polyfit_y), color='green')
tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
tH_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(tH_lfit, var='lfit_resid') %>%
add_predictions(tH_lfit, var='polyfit_pred') %>%
add_residuals(tH_polyfit,var='polyfit_resid') %>%
add_predictions(tH_polyfit,var='polyfit_pred')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(H_lfit, var='lfit_resid') %>%
add_predictions(H_lfit, var='polyfit_pred') %>%
add_residuals(H_polyfit,var='polyfit_resid') %>%
add_predictions(H_polyfit,var='polyfit_pred')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(H_lfit, var='H_lfit_resid') %>%
add_predictions(H_lfit, var='H_polyfit_pred') %>%
add_residuals(H_polyfit,var='H_polyfit_resid') %>%
add_predictions(H_polyfit,var='H_polyfit_pred')
my_qH %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit))
my_qH %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_pred), color = 'red') +
geom_line(aes(x, H_lfit_pred), color = 'blue')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(H_lfit, var='H_lfit_resid') %>%
add_predictions(H_lfit, var='H_lfit_pred') %>%
add_residuals(H_polyfit,var='H_polyfit_resid') %>%
add_predictions(H_polyfit,var='H_polyfit_pred')
my_qH %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_pred), color = 'red') +
geom_line(aes(x, H_lfit_pred), color = 'blue')
my_tH <- my_training %>% filter(Group == 'H')
H_lfit <- lm(y~x, data = my_tH)
H_polyfit <- lm(y~poly(x, 5), my_tH)
tH_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y') %>%
add_residuals(H_lfit, var = 'H_lfit_resid')
tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
tH_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
H_polyfit <- lm(y~poly(x, 2), my_tH)
tH_lfit <- my_tH %>%
add_predictions(H_lfit, var = 'H_lfit_y') %>%
add_residuals(H_lfit, var = 'H_lfit_resid')
tH_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(H_lfit_y, x), color = 'blue')
tH_polyfit <- my_tH %>%
add_predictions(H_polyfit, var = 'H_polyfit_y') %>%
add_residuals(H_polyfit, var = 'H_polyfit_resid')
tH_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_y), color='green')
my_qH <- my_query %>%
filter(Group == 'H') %>%
add_residuals(H_lfit, var='H_lfit_resid') %>%
add_predictions(H_lfit, var='H_lfit_pred') %>%
add_residuals(H_polyfit,var='H_polyfit_resid') %>%
add_predictions(H_polyfit,var='H_polyfit_pred')
my_qH %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, H_polyfit_pred), color = 'red') +
geom_line(aes(x, H_lfit_pred), color = 'blue')
my_tF <- my_training %>% filter(Group == 'F')
F_lfit <- lm(y~x, data = my_tF)
F_polyfit <- lm(y~poly(x, 2), my_tF)
tF_lfit <- my_tF %>%
add_predictions(F_lfit, var = 'F_lfit_y') %>%
add_residuals(F_lfit, var = 'F_lfit_resid')
tF_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(F_lfit_y, x), color = 'blue')
tF_polyfit <- my_tF %>%
add_predictions(F_polyfit, var = 'F_polyfit_y') %>%
add_residuals(F_polyfit, var = 'F_polyfit_resid')
tF_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, F_polyfit_y), color='green')
tF_lfit %>% ggplot() + geom_point(aes(y, x)) +
geom_line(aes(F_lfit_y, x), color = 'blue')
tF_polyfit <- my_tF %>%
add_predictions(F_polyfit, var = 'F_polyfit_y') %>%
add_residuals(F_polyfit, var = 'F_polyfit_resid')
my_tF <- my_training %>% filter(Group == 'F')
F_lfit <- lm(y~x, data = my_tF)
F_polyfit <- lm(y~poly(x, 2), my_tF)
tF_lfit <- my_tF %>%
add_predictions(F_lfit, var = 'F_lfit_y') %>%
add_residuals(F_lfit, var = 'F_lfit_resid')
tF_lfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(F_lfit_y, x), color = 'blue')
tF_lfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, F_lfit_y), color = 'blue')
tF_polyfit <- my_tF %>%
add_predictions(F_polyfit, var = 'F_polyfit_y') %>%
add_residuals(F_polyfit, var = 'F_polyfit_resid')
tF_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, F_polyfit_y), color='green')
tF_lfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, F_lfit_y), color = 'blue')
my_qF <- my_query %>%
filter(Group == 'F') %>%
add_residuals(F_lfit, var='F_lfit_resid') %>%
add_predictions(F_lfit, var='F_lfit_pred') %>%
add_residuals(F_polyfit,var='F_polyfit_resid') %>%
add_predictions(F_polyfit,var='F_polyfit_pred')
tF_polyfit %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, F_polyfit_y), color='green')
my_qF <- my_query %>%
filter(Group == 'F') %>%
add_residuals(F_lfit, var='F_lfit_resid') %>%
add_predictions(F_lfit, var='F_lfit_pred') %>%
add_residuals(F_polyfit,var='F_polyfit_resid') %>%
add_predictions(F_polyfit,var='F_polyfit_pred')
my_qF %>% ggplot() + geom_point(aes(x, y)) +
geom_line(aes(x, F_polyfit_pred), color = 'red') +
geom_line(aes(x, F_lfit_pred), color = 'blue')
View(tF_polyfit)
