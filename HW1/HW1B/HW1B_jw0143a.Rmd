---
output:
  pdf_document: default
  html_document: default
  
title: "Homework 1C - DATA-312"
author: "Jeffrey Williams"
abstract: "This writeup explores the dataset, FirstYearGPA, from the R library, Stat2Data. Categorical variables in this dataset utilize boolean values for identification. These variables are as follows: Male, FirstGen, White, CollegeBound. Numerical variables are as follows: GPA, HSGPA, SATV, SATM, HU, SS."
date: '`r format(Sys.time(), "%d, %B %Y")`'

---
```{r include = FALSE}
knitr::opts_chunk$set(fig.height = 4.4)

```


> Accessible as a library in R, this dataset comprises information from "a sample of 2019 first year students at a midwestern college", with the original intention of constructing an informed prediction of their first year GPA using various categorical and numerical variables. 

> NUMERICAL VARIABLES:

> GPA: Represents the grade point average of any given student in their first year of college.

> HSGPA: Represents the grade point average of any given student in high school.

> SATV: Represents the SAT score of any given student with respect to the Verbal/Literacy portion.

> SATM: Represents the SAT score of any given student with respect to the Mathematics portion.

> HU: Representative of how many credit hours any given student has earned in high school humanities courses.

> SS: Representative of how many credit hours any given student has earned in high school social science courses.

> CATEGORICAL VARIABLES:

> FirstGen: Boolean variable (0/1) representative of whether student is first in their family to attend college.

> White: Boolean variable (0/1) representative of whether student identifies as White.

> CollegeBound: Boolean variable (0/1) representative of whether student attended a high school where 50% of the student body (or greater) indicates intention to attend college.


\pagebreak

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# HW1B
# Jeffrey Williams
# Dr. Robinson
# January 28, 2022


# Clearing workspace
rm(list=ls())
gc()

# Invoking / installing libraries and fetching data
library(tidyverse)
library(Stat2Data)
data("FirstYearGPA")
head(FirstYearGPA)
summary(FirstYearGPA)
sapply(FirstYearGPA, class)


```
 
```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
hist(FirstYearGPA$GPA)

# Numerical Variables: GPA, HSGPA, SATV, SATM, HU, SS
# Categorical Variables (All are Binary): Male, FirstGen, White, CollegeBound

# Identifying mean, variance, and standard deviation for numerical variable,
# GPA
mean(FirstYearGPA$GPA)
var(FirstYearGPA$GPA)
sd(FirstYearGPA$GPA)

# Finding correlation between two numerical variables, HSGPA and GPA
cor(FirstYearGPA$GPA, FirstYearGPA$HSGPA)
```

> The following provides visual representation of the distributions of the variables in the dataset that are classified as numerical. These distributions permit further conceptualization of the standings of students at the closure of their high school careers with respect to their GPA, SAT scores, and the numbers of credit hours they have earned for various types of classes.


```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
knitr::opts_chunk$set(fig.width=6)
ggplot(FirstYearGPA) + geom_histogram(aes(x = GPA)) + 
  labs(title="GPA Distribution - First Year in College",
       x = "GPA",
       y = "Student Count")

ggplot(FirstYearGPA) + geom_histogram(aes(x = HSGPA)) + 
  labs(title="GPA Distribution - High School",
       x = "High School GPA",
       y = "Student Count")

ggplot(FirstYearGPA) + geom_histogram(aes(x = SATM)) + 
  labs(title="SAT: Mathematics Score Distribution",
       x = "SAT-M",
       y = "Student Count")

ggplot(FirstYearGPA) + geom_histogram(aes(x = SATV)) + 
  labs(title="SAT: Verbal/Literacy Score Distribution",
       x = "SAT-V", 
       y = "Student Count")

ggplot(FirstYearGPA) + geom_histogram(aes(x = HU)) + 
  labs(title="Credit Hour Distribution for High School Humanities Courses", 
       x = "# of Humanities Credit Hours",
       y = "Student Count")

ggplot(FirstYearGPA) + geom_histogram(aes(x = SS)) + 
  labs(title="Credit Hour Distribution for High School Social Science Courses", 
       x = "# of Social Science Credit Hours",
       y = "Student Count")

```

> The following provides appropriate visual representation of the distributions of categorical variables identified in the dataset. As previously stated, these categorical variables consist strictly of boolean values, with 0 indicating falsity of a certain identity/status of a student, and 1 indicating that a student identifies with a given condition.

```{r include = FALSE}
knitr::opts_chunk$set(fig.height = 3, fig.width = 2)

```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
ggplot(FirstYearGPA) + geom_bar(aes(x = White)) + 
  labs(title="White Students", 
       x = "Students who Identify as White",
       y = "Student Count")

```
```{r include = FALSE}
knitr::opts_chunk$set(fig.height =  4, fig.width = 4)

```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# First scatter-plot and line of best fit for numerical variables
# Numerical Variables: College and High School GPA (GPA, HSGPA)
plot(FirstYearGPA$HSGPA, FirstYearGPA$GPA,
     main = "High School GPA vs. First Year College GPA",
     xlab = "GPA - First Year in College",
     ylab = "GPA - High School")
myline <- lm(FirstYearGPA$GPA ~ FirstYearGPA$HSGPA)
abline(myline)

# Retrieving analytical information about graph / line
summary(myline)
coef(myline)
```



```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}

# ANALYSIS: There is statistical significance for the given correlation at the 
# 95% confidence interval

# Equation for line of best fit: y = 0.56x + 1.18

# Creating scatter-plots, experimenting with Tidyverse
ggplot(FirstYearGPA)+geom_point(aes(HSGPA, GPA))
ggplot(FirstYearGPA, aes(HSGPA, GPA))+geom_point()
FirstYearGPA %>% ggplot(aes(HSGPA, GPA)) + geom_point()
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# Scatter-plot colored by the categorical variable, CollegeBound
ggplot(data=FirstYearGPA) +
  geom_point(mapping=aes(x=HSGPA, y=GPA, color=CollegeBound))
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# Scatter-plot with the points colored by the numerical variable, SATM
ggplot(data=FirstYearGPA) +
  geom_point(mapping=aes(x=HSGPA, y=GPA, color=SATM))

```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# Loess Curves
ggplot(data=FirstYearGPA) +
  geom_smooth(mapping=aes(x=HSGPA, y=GPA, color=SATM))
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# Adding layers upon layers
ggplot(data=FirstYearGPA) +
  geom_smooth(mapping=aes(x=HSGPA, y=GPA, color=SATM)) +
  geom_point(mapping=aes(x=HSGPA, y=GPA, color=SATM))
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
ggplot(data=FirstYearGPA) + 
  geom_smooth(mapping=aes(x=HSGPA, y=GPA, linetype=as.factor(FirstGen)))
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
ggplot(data=FirstYearGPA) +
  geom_point(mapping=aes(x=HSGPA, y=GPA, color=SATM)) +
  geom_smooth(mapping=aes(x=HSGPA, y=GPA, color=SATM)) 
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# Some experimentation with Facet Plots
ggplot(data=FirstYearGPA) + 
  geom_point(mapping=aes(x=HSGPA, y=GPA)) + 
  facet_wrap(~FirstGen)
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
ggplot(data=FirstYearGPA) + 
  geom_point(mapping=aes(x=HSGPA, y=GPA)) + 
  facet_wrap(CollegeBound~FirstGen)
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
ggplot(data=FirstYearGPA) + 
  geom_point(mapping=aes(x=HSGPA, y=GPA)) + 
  facet_grid(CollegeBound~FirstGen)
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# Creating subsets based on Boolean categorical variable, White
iswhite <- FirstYearGPA[FirstYearGPA$White==1,]
nonwhite <- FirstYearGPA[FirstYearGPA$White==0,]

# Conversion of binary variable, White, into Boolean statements for future use
FirstYearGPA$whiteBoolean <- FirstYearGPA$White > 0
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# T-test: Statistically Significant difference at 95% CI with p-value = 0.00025
t.test(nonwhite$GPA, iswhite$GPA)
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# Bar plot understanding proportion that are first-generation college students
ggplot(data=FirstYearGPA) + geom_bar(mapping=aes(x=FirstGen, y=stat(prop)))
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# Chi-square test on two categorical variables
# Statistical significance between two categorical variables at 95% CI
newtable <- table(FirstYearGPA$FirstGen, FirstYearGPA$White)
newtable
chsq=chisq.test(newtable)
chsq
chsq$observed
chsq$expected
round(chsq$expected, 2)
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# Creating a pie-chart
mytable <- table(FirstYearGPA$White)
myLabels <- names(mytable)
pie(mytable, myLabels, main="% of White Students")
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# Step 43b: examining ratios; how many non-white/white first-gens?
ggplot(data=FirstYearGPA) + geom_bar(mapping=aes(x=FirstGen, fill=whiteBoolean),
                                     position="fill")
```

```{r echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
# Use of stat summary, examining GPA differences in those who identify with
# category "White" and those who do not
ggplot(data=FirstYearGPA) +
  stat_summary(mapping=aes(x=White, y=GPA))

# 45. stat_summary appears to be associated with geom_pointrange. I figured this
# out by submitting "?stat_summary" into the console and looking at usage
# information.
```

